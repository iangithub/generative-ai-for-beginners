<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "ce8224073b86b728ed52b19bed7932fd",
  "translation_date": "2025-07-09T11:42:31+00:00",
  "source_file": "06-text-generation-apps/README.md",
  "language_code": "zh-tw"
}
-->
# 建置文字生成應用程式

[![建置文字生成應用程式](../../../translated_images/06-lesson-banner.a5c629f990a636c852353c5533f1a6a218ece579005e91f96339d508d9cf8f47.en.png)](https://aka.ms/gen-ai-lesson6-gh?WT.mc_id=academic-105485-koreyst)

> _（點擊上方圖片觀看本課影片）_

到目前為止，在本課程中，您已經接觸到像提示這樣的核心概念，甚至是一個稱為「提示工程」的整個領域。您互動的許多工具，例如 ChatGPT、Office 365、Microsoft Power Platform 等，都使用提示來幫助您完成任務。

若要將此類體驗新增至應用程式，您需要了解提示和完成等概念，並選擇要使用的程式庫。這正是您將在本章中學到的內容。

## 簡介

在本章中，您將：

- 了解 openai 程式庫及其核心概念。
- 使用 openai 建置文字生成應用程式。
- 了解如何使用提示、溫度和權杖等概念來建立文字生成應用程式。

## 學習目標

在本課結束時，您將能夠：

- 解釋什麼是文字生成應用程式。
- 使用 openai 建置文字生成應用程式。
- 設定您的應用程式以使用更多或更少的權杖，並調整溫度以獲得不同的輸出。

## 什麼是文字生成應用程式？

通常，當您建置應用程式時，它具有某種介面，如下所示：

- **基於指令**。主控台應用程式是典型的範例，您可以在其中輸入指令，它會執行一項任務。例如，`git` 是一個基於指令的應用程式。
- **使用者介面 (UI)**。有些應用程式具有圖形使用者介面 (GUI)，您可以在其中按一下按鈕、輸入文字、選取選項等等。

### 主控台和 UI 應用程式的限制

將此與您輸入指令的指令型應用程式進行比較：

- **它有限制。** 您不能只輸入任何指令，只能輸入應用程式支援的指令。
- **特定語言。** 有些應用程式支援多種語言，但預設情況下，應用程式是針對特定語言建置的，即使您可以新增更多語言支援。

### 文字生成應用程式的優點

那麼文字生成應用程式有何不同？

在文字生成應用程式中，您有更大的彈性——您不受限於固定的指令集或特定的輸入語言。相反地，您可以使用自然語言與應用程式互動。另一個優點是您正在與一個在大量資訊上訓練的資料來源互動，而傳統應用程式可能僅限於資料庫中的內容。

### 我可以用文字生成應用程式建置什麼？

可能性很多。例如：

- **聊天機器人。** 一個能回答有關您公司及其產品等主題問題的聊天機器人會是一個很好的選擇。
- **小幫手。** LLM 在摘要文字、擷取見解、產生履歷等文字方面表現出色。
- **程式碼助理。** 根據您使用的語言模型，您可以建置一個程式碼助理來幫助您撰寫程式碼。例如，您可以使用像 GitHub Copilot 或 ChatGPT 這樣的產品來協助編碼。

## 我該如何開始？

您需要找到一種與 LLM 整合的方法，這通常涉及兩種方法之一：

- **使用 API。** 在這裡，您建構包含提示的 Web 請求，並在回應中接收產生的文字。
- **使用程式庫。** 程式庫封裝了 API 呼叫，使其更易於使用。

## 程式庫/SDK

有幾個知名的程式庫可用於處理 LLM，例如：

- **openai**，可讓您輕鬆連接到您的模型並傳送提示。

還有一些在更高層級運作的程式庫，例如：

- **Langchain。** Langchain 很有名，並支援 Python。
- **Semantic Kernel。** Semantic Kernel 是 Microsoft 的程式庫，支援 C#、Python 和 Java。

## 第一個使用 openai 的應用程式

讓我們來看看如何建置我們的第一個應用程式，我們需要哪些程式庫，需要多少設定等等。

### 安裝 openai

有許多程式庫可用於與 OpenAI 或 Azure OpenAI 互動。您可以使用各種程式語言，例如 C#、Python、JavaScript、Java 等。我們選擇使用 `openai` Python 程式庫，因此我們將使用 `pip` 來安裝它。

```bash
pip install openai
```

### 建立資源

您需要完成以下步驟：

- 在 Azure [https://azure.microsoft.com/free/](https://azure.microsoft.com/free/?WT.mc_id=academic-105485-koreyst) 上建立一個帳戶。
- 取得 Azure OpenAI 的存取權。請造訪 [https://learn.microsoft.com/azure/ai-services/openai/overview#how-do-i-get-access-to-azure-openai](https://learn.microsoft.com/azure/ai-services/openai/overview#how-do-i-get-access-to-azure-openai?WT.mc_id=academic-105485-koreyst) 並申請存取權。

  > [!NOTE]
  > 在撰寫本文時，您需要申請才能存取 Azure OpenAI。

- 安裝 Python <https://www.python.org/>
- 建立 Azure OpenAI 服務資源。請參閱本指南以了解如何[建立資源](https://learn.microsoft.com/azure/ai-services/openai/how-to/create-resource?pivots=web-portal?WT.mc_id=academic-105485-koreyst)。

### 尋找 API 金鑰和端點

現在，您需要告訴您的 `openai` 程式庫要使用哪個 API 金鑰。若要尋找您的 API 金鑰，請前往您的 Azure OpenAI 資源的「金鑰和端點」部分，然後複製「金鑰 1」的值。

![Azure 入口網站中的金鑰和端點資源刀鋒視窗](https://learn.microsoft.com/azure/ai-services/openai/media/quickstarts/endpoint.png?WT.mc_id=academic-105485-koreyst)

複製此資訊後，讓我們設定程式庫以使用它。

> [!NOTE]
> 將您的 API 金鑰與您的程式碼分開是一個好主意。您可以使用環境變數來做到這一點。
>
> - 將環境變數 `OPENAI_API_KEY` 設定為您的 API 金鑰。
>   `export OPENAI_API_KEY='sk-...'`

### Azure 的設定組態

如果您正在使用 Azure OpenAI，以下是設定組態的方法：

```python
openai.api_type = 'azure'
openai.api_key = os.environ["OPENAI_API_KEY"]
openai.api_version = '2023-05-15'
openai.api_base = os.getenv("API_BASE")
```

在上方，我們正在設定以下內容：

- `api_type` 為 `azure`。這會告訴程式庫使用 Azure OpenAI 而非 OpenAI。
- `api_key`，這是您在 Azure 入口網站中找到的 API 金鑰。
- `api_version`，您要使用的 API 版本。在撰寫本文時，最新版本為 `2023-05-15`。
- `api_base`，API 端點。您可以在 Azure 入口網站中您的 API 金鑰旁邊找到它。

> [!NOTE]
> `os.getenv` 是一個讀取環境變數的函式。您可以使用它來讀取像 `OPENAI_API_KEY` 和 `API_BASE` 這樣的環境變數。在您的終端機中或使用像 `dotenv` 這樣的程式庫來設定這些環境變數。

## 產生文字

若要產生文字，請使用 `Completion` 類別。以下是一個範例：

```python
prompt = "完成以下句子：從前從前有一個"

completion = openai.Completion.create(model="davinci-002", prompt=prompt)
print(completion.choices[0].text)
```

在上面的程式碼中，我們建立了一個完成物件，指定了我們想要使用的模型，並提供了提示。然後我們印出產生的文字。

### 聊天完成

到目前為止，您已經了解如何使用 `Completion` 來產生文字。但還有另一個名為 `ChatCompletion` 的類別，它更適合聊天機器人。以下是如何使用它的範例：

```python
import openai

openai.api_key = "sk-..."

completion = openai.ChatCompletion.create(model="gpt-3.5-turbo", messages=[{"role": "user", "content": "Hello world"}])
print(completion.choices[0].message.content)
```

我們將在接下來的章節中更詳細地介紹此功能。

## 練習 - 您的第一個文字生成應用程式

現在您知道如何設定和組態 openai，是時候建置您的第一個文字生成應用程式了。請遵循以下步驟：

1. 建立一個虛擬環境並安裝 openai：

   ```bash
   python -m venv venv
   source venv/bin/activate
   pip install openai
   ```

   > [!NOTE]
   > 如果您使用 Windows，請輸入 `venv\Scripts\activate` 而非 `source venv/bin/activate`。

   > [!NOTE]
   > 前往 [https://portal.azure.com/](https://portal.azure.com/?WT.mc_id=academic-105485-koreyst)，搜尋 `Open AI`，選取 `Open AI 資源`，然後前往 `金鑰和端點` 並複製 `金鑰 1` 的值，即可找到您的 Azure OpenAI 金鑰。

2. 建立一個 _app.py_ 檔案並新增下列程式碼：

   ```python
   import openai

   openai.api_key = "<將此值取代為您的 open ai 金鑰或 Azure OpenAI 金鑰>"

   openai.api_type = 'azure'
   openai.api_version = '2023-05-15'
   openai.api_base = "<在 Azure 入口網站中您的 API 金鑰所在位置找到的端點>"
   deployment_name = "<部署名稱>"

   # 新增您的完成程式碼
   prompt = "完成下列句子：從前從前有一個"
   messages = [{"role": "user", "content": prompt}]

   # 進行完成
   completion = openai.chat.completions.create(model=deployment_name, messages=messages)

   # 列印回應
   print(completion.choices[0].message.content)
   ```

   > [!NOTE]
   > 如果您使用 Azure OpenAI，請將 `api_type` 設定為 `azure`，並將 `api_key` 設定為您的 Azure OpenAI 金鑰。

   您應該會看到類似以下的輸出：

   ```output
    一個非常不快樂的 _____。

   從前從前有一個非常不快樂的美人魚。
   ```

## 不同類型的提示，用於不同目的

現在您已經了解如何使用提示來產生文字。您甚至有一個可以修改以產生不同類型文字的運作中程式。

提示可用於許多任務。例如：

- **產生一種文字類型。** 例如，您可以產生一首詩、測驗問題等。
- **查詢資訊。** 您可以使用提示來尋找資訊，例如「CORS 在 Web 開發中是什麼意思？」
- **產生程式碼。** 您可以使用提示來產生程式碼，例如建立一個驗證電子郵件的正規表示式，甚至產生一個像 Web 應用程式這樣的完整程式。

## 一個更實際的應用案例：食譜產生器

想像一下，您家裡有一些食材，想做點什麼。為此，您需要一份食譜。您可以使用搜尋引擎或 LLM 來尋找食譜。

您可能會寫下這樣的提示：

> 「給我 5 個使用以下食材的菜餚食譜：雞肉、馬鈴薯和胡蘿蔔。每個食譜都列出所有使用的食材。」

根據這個提示，您可能會得到像這樣的回應：

```output
1. 烤雞和蔬菜：
食材：
- 4 塊雞腿
- 2 個馬鈴薯，切塊
- 2 根胡蘿蔔，切塊
- 2 湯匙橄欖油
- 2 瓣大蒜，切末
- 1 茶匙乾百里香
- 1 茶匙乾奧勒岡
- 鹽和胡椒，適量

2. 雞肉馬鈴薯燉菜：
食材：
- 2 湯匙橄欖油
- 1 個洋蔥，切丁
- 2 瓣大蒜，切末
- 2 塊雞胸肉，切塊
- 2 個馬鈴薯，切塊
- 2 根胡蘿蔔，切塊
- 1 茶匙乾奧勒岡
- 1 茶匙乾百里香
- 1 杯雞湯
- 鹽和胡椒，適量

3. 雞肉馬鈴薯焗烤：
食材：
- 2 湯匙橄欖油
- 2 塊雞胸肉，切塊
- 2 個馬鈴薯，切塊
- 2 根胡蘿蔔，切塊
- 1 個洋蔥，切丁
- 2 瓣大蒜，切末
- 1 茶匙乾奧勒岡
- 1 茶匙乾百里香
- 1 杯雞湯
- 鹽和胡椒，適量

4. 雞肉馬鈴薯湯：
食材：
- 2 湯匙橄欖油
- 1 個洋蔥，切丁
- 2 瓣大蒜，切末
- 2 塊雞胸肉，切塊
- 2 個馬鈴薯，切塊
- 2 根胡蘿蔔，切塊
- 1 茶匙乾奧勒岡
- 1 茶匙乾百里香
- 4 杯雞湯
- 鹽和胡椒，適量

5. 雞肉馬鈴薯雜燴：
食材：
- 2 湯匙橄欖油
- 2 塊雞胸肉，切塊
- 2 個馬鈴薯，切塊
- 2 根胡蘿蔔，切塊
- 1 個洋蔥，切丁
- 2 瓣大蒜，切末
- 1 茶匙乾奧勒岡
```

這個結果很棒——我知道該煮什麼了。此時，有用的改進可能是：

- 過濾掉我不喜歡或過敏的食材。
- 如果我家中沒有所有食材，則產生一份購物清單。

對於這些情況，讓我們新增一個額外的提示：

> 「請移除含有大蒜的食譜，因為我對大蒜過敏，並用其他東西取代。另外，請為食譜產生一份購物清單，並考慮到我家中已經有雞肉、馬鈴薯和胡蘿蔔。」

現在您會得到一個新的結果，即：

```output
1. 烤雞和蔬菜：
食材：
- 4 塊雞腿
- 2 個馬鈴薯，切塊
- 2 根胡蘿蔔，切塊
- 2 湯匙橄欖油
- 1 茶匙乾百里香
- 1 茶匙乾奧勒岡
- 鹽和胡椒，適量

2. 雞肉馬鈴薯燉菜：
食材：
- 2 湯匙橄欖油
- 1 個洋蔥，切丁
- 2 塊雞胸肉，切塊
- 2 個馬鈴薯，切塊
- 2 根胡蘿蔔，切塊
- 1 茶匙乾奧勒岡
- 1 茶匙乾百里香
- 1 杯雞湯
- 鹽和胡椒，適量

3. 雞肉馬鈴薯焗烤：
食材：
- 2 湯匙橄欖油
- 2 塊雞胸肉，切塊
- 2 個馬鈴薯，切塊
- 2 根胡蘿蔔，切塊
- 1 個洋蔥，切丁
- 1 茶匙乾奧勒岡
- 1 茶匙乾百里香
- 1 杯雞湯
- 鹽和胡椒，適量

4. 雞肉馬鈴薯湯：
食材：
- 2 湯匙橄欖油
- 1 個洋蔥，切丁
- 2 塊雞胸肉，切塊
- 2 個馬鈴薯，切塊
- 2 根胡蘿蔔，切塊
- 1 茶匙乾奧勒岡
- 1 茶匙乾百里香
- 4 杯雞湯
- 鹽和胡椒，適量

5. 雞肉馬鈴薯雜燴：
食材：
- 2 湯匙橄欖油
- 2 塊雞胸肉，切塊
- 2 個馬鈴薯，切塊
- 2 根胡蘿蔔，切塊
- 1 個洋蔥，切丁
- 1 茶匙乾奧勒岡

購物清單：
- 橄欖油
- 洋蔥
- 百里香
- 奧勒岡
- 鹽
- 胡椒
```

這是您沒有大蒜的五份食譜，外加一份考慮到您家中已有食材的購物清單。

## 練習 - 建置食譜產生器

現在我們已經探討了一個情境，讓我們來撰寫程式碼來配合它。請遵循以下步驟：

1. 使用現有的 _app.py_ 檔案作為起點。
2. 找到 `prompt` 變數並將其程式碼取代為以下內容：

   ```python
   prompt = "給我 5 個使用以下食材的菜餚食譜：雞肉、馬鈴薯和胡蘿蔔。每個食譜都列出所有使用的食材"
   ```

   如果您現在執行程式碼，您應該會看到類似以下的輸出：

   ```output
   - 雞肉燉馬鈴薯和胡蘿蔔：3 湯匙油、1 個洋蔥（切碎）、2 瓣大蒜（切末）、1 根胡蘿蔔（去皮切碎）、1 個馬鈴薯（去皮切碎）、1 片月桂葉、1 根百里香、1/2 茶匙鹽、1/4 茶匙黑胡椒、1 1/2 杯雞湯、1/2 杯乾白酒、2 湯匙切碎的新鮮巴西里、2 湯匙無鹽奶油、1 1/2 磅去骨去皮雞腿肉（切成 1 英寸塊）
   - 烤箱烤雞佐馬鈴薯和胡蘿蔔：3 湯匙特級初榨橄欖油、1 湯匙第戎芥末醬、1 湯匙切碎的新鮮迷迭香、1 湯匙切碎的新鮮百里香、4 瓣大蒜（切末）、1 1/2 磅小紅馬鈴薯（切塊）、1 1/2 磅胡蘿蔔（縱向切塊）、1/2 茶匙鹽、1/4 茶匙黑胡椒、1 隻（4 磅）全雞
   - 雞肉、馬鈴薯和胡蘿蔔砂鍋：烹飪噴霧、1 個大洋蔥（切碎）、2 瓣大蒜（切末）、1 根胡蘿蔔（去皮切絲）、1 個馬鈴薯（去皮切絲）、1/2 茶匙乾百里香葉、1/4 茶匙鹽、1/4 茶匙黑胡椒、2 杯脫脂低鈉雞湯、1 杯冷凍豌豆、1/4 杯通用麵粉、1 杯 2% 減脂牛奶、1/4 杯磨碎的帕瑪森起司

   - 一鍋雞肉和馬鈴薯晚餐：2 湯匙橄欖油、1 磅去骨去皮雞腿肉（切成 1 英寸塊）、1 個大洋蔥（切碎）、3 瓣大蒜（切末）、1 根胡蘿蔔（去皮切碎）、1 個馬鈴薯（去皮切碎）、1 片月桂葉、1 根百里香、1/2 茶匙鹽、1/4 茶匙黑胡椒、2 杯雞湯、1/2 杯乾白酒

   - 雞肉、馬鈴薯和胡蘿蔔咖哩：1 湯匙植物油、1 個大洋蔥（切碎）、2 瓣大蒜（切末）、1 根胡蘿蔔（去皮切碎）、1 個馬鈴薯（去皮切碎）、1 茶匙芫荽粉、1 茶匙孜然粉、1/2 茶匙薑黃粉、1/2 茶匙薑粉、1/4 茶匙辣椒粉、2 杯雞湯、1/2 杯乾白酒、1（15 盎司）罐鷹嘴豆（瀝乾並沖洗）、1/2 杯葡萄乾、1/2 杯切碎的新鮮香菜
   ```

   > 注意：您的 LLM 是不確定的，因此每次執行程式時可能會得到不同的結果。

太棒了！現在讓我們來看看如何改進它。為了讓程式碼更具彈性，我們希望允許變更食材和食譜數量。

1. 修改程式碼如下：

   ```python
   no_recipes = input("食譜數量（例如，5）： ")

   ingredients = input("食材清單（例如，雞肉、馬鈴薯和胡蘿蔔）： ")

   # 將食譜數量和食材插入提示中
   prompt = f"給我 {no_recipes} 個使用以下食材的菜餚食譜：{ingredients}。每個食譜都列出所有使用的食材"
   ```

程式碼的測試執行可能如下所示：

```output
   食譜數量（例如，5）：3
   食材清單（例如，雞肉、馬鈴薯和胡蘿蔔）：牛奶、草莓

   - 草莓奶昔：牛奶、草莓、糖、香草精、冰塊
   - 草莓蛋糕：牛奶、麵粉、泡打粉、糖、鹽、無鹽奶油、草莓、鮮奶油
   - 草莓牛奶：牛奶、草莓、糖、香草精
   ```

### 透過新增篩選器和購物清單來改善

我們現在有一個可以產生食譜的運作中應用程式，而且它很靈活，因為它接受使用者輸入的食譜數量和食材。

為了進一步改善它，我們想新增：

- **過濾食材。** 我們想要排除我們不喜歡或過敏的食材。為此，我們可以編輯現有的提示，並在結尾新增一個篩選條件，如下所示：

  ```python
  filter = input("篩選器（例如，素食、純素或無麩質）： ")

  prompt = f"給我 {no_recipes} 個使用以下食材的菜餚食譜：{ingredients}。每個食譜都列出所有使用的食材，不要 {filter}"
  ```

在上方，我們在提示的結尾新增了 `{filter}`，並從使用者擷取篩選器值。

執行程式時的一個範例輸入可能如下所示：

```output
  食譜數量（例如，5）：3
  食材清單（例如，雞肉、馬鈴薯和胡蘿蔔）：洋蔥、牛奶
  篩選器（例如，素食、純素或無麩質）：不要牛奶

  1. 法式洋蔥湯

  食材：

  - 1 個大洋蔥，切片
  - 3 杯牛肉湯
  - 1 杯牛奶
  - 6 片法式麵包
  - 1/4 杯磨碎的帕瑪森起司
  - 1 湯匙奶油
  - 1 茶匙乾百里香
  - 1/4 茶匙鹽
  - 1/4 茶匙黑胡椒

  說明：

  1. 在一個大鍋中，用奶油將洋蔥炒至金黃色。
  2. 加入牛肉湯、牛奶、百里香、鹽和胡椒。煮沸。
  3. 轉小火，燉煮 10 分鐘。
  4. 將法式麵包片放在湯碗上。
  5. 將湯淋在麵包上。
  6. 撒上帕瑪森起司。

  2. 洋蔥馬鈴薯湯

  食材：

  - 1 個大洋蔥，切碎
  - 2 杯馬鈴薯，切丁
  - 3 杯蔬菜湯
  - 1 杯牛奶
  - 1/4 茶匙黑胡椒

  說明：

  1. 在一個大鍋中，用奶油將洋蔥炒至金黃色。
  2. 加入馬鈴薯、蔬菜湯、牛奶和胡椒。煮沸。
  3. 轉小火，燉煮 10 分鐘。
  4. 趁熱享用。

  3. 奶油洋蔥湯

  食材：

  - 1 個大洋蔥，切碎
  - 3 杯蔬菜湯
  - 1 杯牛奶
  - 1/4 茶匙黑胡椒
  - 1/4 杯通用麵粉
  - 1/2 杯磨碎的帕瑪森起司

  說明：

  1. 在一個大鍋中，用奶油將洋蔥炒至金黃色。
  2. 加入蔬菜湯、牛奶和胡椒。煮沸。
  3. 轉小火，燉煮 10 分鐘。
  4. 在一個小碗中，將麵粉和帕瑪森起司攪拌均勻。
  5. 加入湯中，再燉煮 5 分鐘，或直到湯變稠。
  ```

如您所見，任何含有牛奶的食譜都已被過濾掉。但如果您有乳糖不耐症，您可能也想過濾掉含有起司的食譜，因此具體說明很重要。

- **產生購物清單。** 我們希望在考慮到我們家中已有的食材的情況下產生一份購物清單。

  為此，我們可以嘗試在一個提示中完成所有事情，或將其分成兩個提示。讓我們試試後者。我們將新增一個額外的提示，但為了讓它運作，我們需要將第一個提示的結果作為上下文傳遞給第二個提示。

  找到列印第一個提示結果的程式碼部分，並在下方新增以下內容：

  ```python
  old_prompt_result = completion.choices[0].message.content
  prompt = "為產生的食譜產生一份購物清單，請不要包含我已經有的食材。"

  new_prompt = f"{old_prompt_result} {prompt}"
  messages = [{"role": "user", "content": new_prompt}]
  completion = openai.Completion.create(engine=deployment_name, messages=messages, max_tokens=1200)

  # 列印回應
  print("購物清單：")
  print(completion.choices[0].message.content)
  ```

請注意以下事項：

1. 我們正在透過將第一個提示的結果附加到新提示來建立一個新提示：

   ```python
     new_prompt = f"{old_prompt_result} {prompt}"
     ```
  2. 我們提出一個新的請求，但同時也考慮到我們在第一個提示中要求的權杖數量，所以這次我們說 `max_tokens` 是 1200。

     ```python
     completion = openai.Completion.create(engine=deployment_name, prompt=new_prompt, max_tokens=1200)
     ```

     執行此程式碼，我們會得到以下輸出：

     ```output
     食譜數量（例如，5）：2
     食材清單（例如，雞肉、馬鈴薯和胡蘿蔔）：蘋果、麵粉
     篩選器（例如，素食、純素或無麩質）：糖


     - 蘋果和麵粉煎餅：1 杯麵粉、1/2 茶匙泡打粉、1/2 茶匙小蘇打、1/4 茶匙鹽、1 湯匙糖、1 顆雞蛋、1 杯酪乳或酸牛奶、1/4 杯融化的奶油、1 顆青蘋果（去皮磨碎）
     - 蘋果油條：1-1/2 杯麵粉、1 茶匙泡打粉、1/4 茶匙鹽、1/4 茶匙小蘇打、1/4 茶匙肉豆蔻、1/4 茶匙肉桂、1/4 茶匙多香果、1/4 杯糖、1/4 杯植物起酥油、1/4 杯牛奶、1 顆雞蛋、2 杯磨碎的去皮蘋果
     購物清單：
     - 麵粉、泡打粉、小蘇打、鹽、糖、雞蛋、酪乳、奶油、蘋果、肉豆蔻、肉桂、多香果
     ```

## 改善您的設定

我們目前擁有的程式碼可以運作，但我們應該進行一些調整以進一步改善它。需要考慮的一些事項包括：

- **將密鑰與程式碼分開**，例如 API 金鑰。密鑰不應寫死在程式碼中，而應安全地儲存。為了將密鑰與程式碼分開，我們可以使用環境變數和像 `python-dotenv` 這樣的程式庫從檔案中載入它們。以下是程式碼中的樣子：

  1. 建立一個 `.env` 檔案，內容如下：

     ```bash
     OPENAI_API_KEY=sk-...
     ```

     
> 注意，對於 Azure，您需要設定以下環境變數：

     ```bash
     OPENAI_API_TYPE=azure
     OPENAI_API_VERSION=2023-05-15
     OPENAI_API_BASE=<replace>
     ```

     在您的程式碼中，您會像這樣載入環境變數：

     ```python
     from dotenv import load_dotenv

     load_dotenv()

     openai.api_key = os.environ["OPENAI_API_KEY"]
     ```

- **關於權杖長度的一句話**。我們應該考慮需要多少權杖才能產生我們想要的文字。權杖需要花錢，所以盡可能地有效率地使用權杖。例如，我們能否用更少的權杖來表達提示？

  若要調整使用的權杖，您可以設定 `max_tokens` 參數。例如，如果您想使用 100 個權杖，您可以這樣做：

  ```python
  completion = client.chat.completions.create(model=deployment, messages=messages, max_tokens=100)
  ```

- **實驗溫度**。溫度尚未提及，但它是一個重要的設定，會影響您的程式行為。溫度越高，輸出就越隨機。相反地，溫度越低，輸出就越可預測。思考一下您是否希望輸出有更多變化。

  若要變更溫度，請使用 `temperature` 參數。例如，若要將溫度設定為 0.5，您可以這樣做：

  ```python
  completion = client.chat.completions.create(model=deployment, messages=messages, temperature=0.5)
  ```

  > 注意，越接近 1.0，輸出就越多樣化。

## 作業

對於此作業，您可以選擇要建置的內容。

這裡有一些想法：

- 調整食譜產生器應用程式以進一步改善它。實驗溫度值和提示，看看您能創造出什麼。
- 建置一個「學習夥伴」。這個應用程式應該能夠回答有關某個主題的問題，例如 Python。您可以有像「Python 中的某個主題是什麼？」或「給我看某個主題的程式碼」等提示。
- 歷史機器人：透過指示機器人扮演某個歷史人物並向其詢問有關其生活和時代的問題，讓歷史栩栩如生。

## 解決方案

### 學習夥伴

以下是一個入門提示。看看您如何使用它並根據自己的喜好進行客製化。

```text
- 「您是 Python 語言的專家

    以以下格式建議一個 Python 的初學者課程：

    格式：
    - 概念：
    - 課程的簡要說明：
    - 附有解答的程式碼練習」
```

### 歷史機器人

這裡有一些您可以使用的提示：

```text
- 「你是林肯，用 3 句話介紹你自己，並使用林肯會使用的文法和詞彙來回應」
- 「你是林肯，請使用林肯會使用的文法和詞彙來回應：

   用 300 字告訴我你最大的成就」
```

## 知識測驗

溫度設定有什麼作用？

1. 它控制輸出的隨機性。
2. 它控制回應的長度。
3. 它控制使用的權杖數量。

## 🚀 挑戰

在完成作業時，嘗試將溫度設定為 0、0.5 和 1 來改變溫度。請記住，0 產生的變化最小，1 產生的變化最大。哪個值最適合您的應用程式？

## 做得好！繼續學習

完成本課程後，請查看我們的 [生成式 AI 學習合輯](https://aka.ms/genai-collection?WT.mc_id=academic-105485-koreyst) 以繼續增進您的生成式 AI 技能！

前往第 7 課，我們將探討如何[建置聊天應用程式](../07-building-chat-applications/README.md?WT.mc_id=academic-105485-koreyst)！

**免責聲明**：
本文件已使用 AI 翻譯服務 [Co-op Translator](https://github.com/Azure/co-op-translator) 進行翻譯。雖然我們力求準確，但請注意，自動翻譯可能包含錯誤或不準確之處。應以其母語的原始文件為權威來源。對於關鍵資訊，建議進行專業的人工翻譯。我們對因使用本翻譯而產生的任何誤解或曲解概不負責。